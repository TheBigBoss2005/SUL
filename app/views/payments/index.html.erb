<% provide(:title, '支払情報一覧') %>
<div class="container">

  <div class="bs-docs-section">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2">
        <div class="page-header">
          <h1>支払情報一覧</h1>
        </div>
      </div>
    </div>
  </div>

  <%= form_tag '/payments/index' do %>
    <div class="bs-docs-section">
      <div class="row">
        <div class="col-lg-8 col-lg-offset-2">
          <div class="form-group">
            <%= label :payment, :filter_by_event, 'イベントでフィルタ', class: 'col-lg-3 control-label' %>
            <div class="col-lg-3">
              <select id='filter_by_event' class="form-control">
                <option value='none'>しない</option>
                <% @events.each do |e| %>
                  <option value='<%= e.id %>'><%= e.name %></option>
                <% end %>
              </select>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col-lg-8 col-lg-offset-2">
        <div class="form-group">
          <%= label :payment, :filter_by_user, 'ユーザでフィルタ', class: 'col-lg-3 control-label' %>
          <div class="col-lg-3">
            <select id='filter_by_user' class="form-control">
              <option value='none'>しない</option>
              <% @users.each do |u| %>
                <option value='<%= u.id %>'><%= u.name %></option>
              <% end %>
            </select>
          </div>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col-lg-8 col-lg-offset-2">
        <% if @payments.count == 0 %>
          支払情報がありません
        <% else %>
          <%= paginate @payments %>
          <table class="table table-striped table-hover">
            <thead>
              <tr>
                <th>イベント</th>
                <th>支払元</th>
                <th>支払先</th>
                <th>品目</th>
                <th>金額</th>
                <th>精算状況</th>
              </tr>
            </thead>
            <tbody>
              <% @payments.each do |payment| %>
                <tr>
                  <td><%= payment.item.event.name %></td>
                  <td><%= payment.participant.user.name %></td>
                  <td><%= payment.item.user.name %></td>
                  <td><%= payment.item.memo %></td>
                  <td><%= payment.price %></td>
                  <td><%= payment.status ? '精算済' : '未精算' %></td>
                </tr>
              <% end %>
            </tbody>
          </table>
          <%= paginate @payments %>
        <% end %>
      </div>
    </div>
  <% end %>
</div>
